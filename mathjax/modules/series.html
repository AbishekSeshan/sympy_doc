

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Series Expansions &mdash; SymPy v0.7.0-git documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.0-git',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://mathjax.connectmv.com/MathJax.js"></script>
    <link rel="top" title="SymPy v0.7.0-git documentation" href="../index.html" />
    <link rel="up" title="SymPy Modules Reference" href="index.html" />
    <link rel="next" title="Simplify" href="simplify.html" />
    <link rel="prev" title="Term rewriting" href="rewriting.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="simplify.html" title="Simplify"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rewriting.html" title="Term rewriting"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">SymPy v0.7.0-git documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">SymPy Modules Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-sympy.series">
<span id="series-expansions"></span><h1>Series Expansions<a class="headerlink" href="#module-sympy.series" title="Permalink to this headline">¶</a></h1>
<p>The series module implements series expansions as a function and many related
functions.</p>
<div class="section" id="limits">
<h2>Limits<a class="headerlink" href="#limits" title="Permalink to this headline">¶</a></h2>
<p>The main purpose of this module is the computation of limits.</p>
<dl class="function">
<dt id="sympy.series.limits.limit">
<tt class="descclassname">sympy.series.limits.</tt><tt class="descname">limit</tt><big>(</big><em>e</em>, <em>z</em>, <em>z0</em>, <em>dir='+'</em><big>)</big><a class="headerlink" href="#sympy.series.limits.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the limit of e(z) at the point z0.</p>
<p>z0 can be any expression, including oo and -oo.</p>
<p>For dir=&#8221;+&#8221; (default) it calculates the limit from the right
(z-&gt;z0+) and for dir=&#8221;-&#8221; the limit from the left (z-&gt;z0-). For infinite z0
(oo or -oo), the dir argument doesn&#8217;t matter.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">limit</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&quot;+&quot;</span><span class="p">)</span>
<span class="go">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="go">-oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Strategy:</p>
<p>First we try some heuristics for easy and frequent cases like &#8220;x&#8221;, &#8220;1/x&#8221;,
&#8220;x**2&#8221; and similar, so that it&#8217;s fast. For all other cases, we use the
Gruntz algorithm (see the gruntz() function).</p>
</dd></dl>

<p>As is explained above, the workhorse for limit computations is the
function gruntz() which implements Gruntz&#8217; algorithm for computing limits.</p>
<div class="section" id="the-gruntz-algorithm">
<h3>The Gruntz Algorithm<a class="headerlink" href="#the-gruntz-algorithm" title="Permalink to this headline">¶</a></h3>
<p>This section explains the basics of the algorithm used for computing limits.
Most of the time the limit() function should just work. However it is still
useful to keep in mind how it is implemented in case something does not work
as expected.</p>
<p>First we define an ordering on functions. Suppose $f(x)$ and $g(x)$ are two
real-valued functions such that $lim_{x to infty} f(x) = infty$ and
similarly $lim_{x to infty} g(x) = infty$. We shall say that $f(x)$
<em>dominates</em>
$g(x)$, written $f(x) succ g(x)$, if for all $a, b in mathbb{R}_{&gt;0}$ we have
$lim_{x to infty} frac{f(x)^a}{g(x)^b} = infty$.
We also say that $f(x)$ and
$g(x)$ are <em>of the same comparability class</em> if neither $f(x) succ g(x)$ nor
$g(x) succ f(x)$ and shall denote it as $f(x) asymp g(x)$.</p>
<p>Note that whenever $a, b in mathbb{R}_{&gt;0}$ then
$a f(x)^b asymp f(x)$, and we shall use this to extend the definition of
$succ$ to all functions which tend to $0$ or $pm infty$ as $x to infty$.
Thus we declare that $f(x) asymp 1/f(x)$ and $f(x) asymp -f(x)$.</p>
<p>It is easy to show the following examples:</p>
<ul class="simple">
<li>$e^x succ x^m$</li>
<li>$e^{x^2} succ e^{mx}$</li>
<li>$e^{e^x} succ e^{x^m}$</li>
<li>$x^m asymp x^n$</li>
<li>$e^{x + frac{1}{x}} asymp e^{x + log{x}} asymp e^x$.</li>
</ul>
<p>From the above definition, it is possible to prove the following property:</p>
<blockquote>
<p>Suppose $omega$, $g_1, g_2, dots$ are functions of $x$,
$lim_{x to infty} omega = 0$ and $omega succ g_i$ for
all $i$. Let $c_1, c_2, dots in mathbb{R}$ with $c_1 &lt; c_2 &lt; dots$.</p>
<p>Then $lim_{x to infty} sum_i g_i omega^{c_i} = lim_{x to infty} g_1 omega^{c_1}$.</p>
</blockquote>
<p>For $g_1 = g$ and $omega$ as above we also have the following easy result:</p>
<blockquote>
<ul class="simple">
<li>$lim_{x to infty} g omega^c = 0$ for $c &gt; 0$</li>
<li>$lim_{x to infty} g omega^c = pm infty$ for $c &lt; 0$,
where the sign is determined by the (eventual) sign of $g$</li>
<li>$lim_{x to infty} g omega^0 = lim_{x to infty} g$.</li>
</ul>
</blockquote>
<p>Using these results yields the following strategy for computing
$lim_{x to infty} f(x)$:</p>
<ol class="arabic simple">
<li>Find the set of <em>most rapidly varying subexpressions</em> (MRV set) of $f(x)$.
That is, from the set of all subexpressions of $f(x)$, find the elements that
are maximal under the relation $succ$.</li>
<li>Choose a function $omega$ that is in the same comparability class as
the elements in the MRV set, such that $lim_{x to infty} omega = 0$.</li>
<li>Expand $f(x)$ as a series in $omega$ in such a way that the antecedents of
the above theorem are satisfied.</li>
<li>Apply the theorem and conclude the computation of
$lim_{x to infty} f(x)$, possibly by recursively working on $g_1(x)$.</li>
</ol>
<div class="section" id="notes">
<h4>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h4>
<p>This exposition glossed over several details. Many are described in the file
gruntz.py, and all can be found in Gruntz&#8217; very readable thesis. The most
important points that have not been explained are:</p>
<ol class="arabic simple">
<li>Given f(x) and g(x), how do we determine if $f(x) succ g(x)$,
$g(x) succ f(x)$ or $g(x) asymp f(x)$?</li>
<li>How do we find the MRV set of an expression?</li>
<li>How do we compute series expansions?</li>
<li>Why does the algorithm terminate?</li>
</ol>
<p>If you are interested, be sure to take a look at
<a class="reference external" href="http://www.cybertester.com/data/gruntz.pdf">Gruntz Thesis</a>.</p>
</div>
</div>
</div>
<div class="section" id="more-intuitive-series-expansion">
<h2>More Intuitive Series Expansion<a class="headerlink" href="#more-intuitive-series-expansion" title="Permalink to this headline">¶</a></h2>
<p>This is achieved
by creating a wrapper around Basic.series(). This allows for the use of
series(x*cos(x),x), which is possibly more intuative than (x*cos(x)).series(x).</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">series</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">series</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
<span class="go">1 - x**2/2 + x**4/24 + O(x**6)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="order-terms">
<h2>Order Terms<a class="headerlink" href="#order-terms" title="Permalink to this headline">¶</a></h2>
<p>This module also implements automatic keeping track of the order of your
expansion.</p>
<div class="section" id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="go">O(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">1 + O(x)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="series-acceleration">
<h2>Series Acceleration<a class="headerlink" href="#series-acceleration" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
<div class="section" id="residues">
<h2>Residues<a class="headerlink" href="#residues" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/sympylogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Series Expansions</a><ul>
<li><a class="reference internal" href="#limits">Limits</a><ul>
<li><a class="reference internal" href="#the-gruntz-algorithm">The Gruntz Algorithm</a><ul>
<li><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#more-intuitive-series-expansion">More Intuitive Series Expansion</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#order-terms">Order Terms</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#series-acceleration">Series Acceleration</a></li>
<li><a class="reference internal" href="#residues">Residues</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="rewriting.html"
                        title="previous chapter">Term rewriting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="simplify.html"
                        title="next chapter">Simplify</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/modules/series.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="simplify.html" title="Simplify"
             >next</a> |</li>
        <li class="right" >
          <a href="rewriting.html" title="Term rewriting"
             >previous</a> |</li>
        <li><a href="../index.html">SymPy v0.7.0-git documentation</a> &raquo;</li>
          <li><a href="index.html" >SymPy Modules Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008, 2009, 2010, 2011 SymPy Development Team.
      Last updated on Jun 30, 2011.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
  </body>
</html>