

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sympy.combinatorics.permutations &mdash; SymPy 0.7.2-git documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.7.2-git',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/SymPy-Favicon.ico"/>
    <link rel="top" title="SymPy 0.7.2-git documentation" href="../../../index.html" />
    <link rel="up" title="sympy.combinatorics" href="../combinatorics.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">SymPy 0.7.2-git documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../sympy.html" >sympy</a> &raquo;</li>
          <li><a href="../combinatorics.html" accesskey="U">sympy.combinatorics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for sympy.combinatorics.permutations</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">sympy.core</span> <span class="kn">import</span> <span class="n">Basic</span><span class="p">,</span> <span class="n">S</span>
<span class="kn">from</span> <span class="nn">sympy.core.compatibility</span> <span class="kn">import</span> <span class="n">is_sequence</span>
<span class="kn">from</span> <span class="nn">sympy.utilities.iterables</span> <span class="kn">import</span> <span class="n">flatten</span>
<span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">lcm</span>
<span class="kn">from</span> <span class="nn">sympy.matrices</span> <span class="kn">import</span> <span class="n">zeros</span>
<span class="kn">from</span> <span class="nn">sympy.mpmath.libmp.libintmath</span> <span class="kn">import</span> <span class="n">ifac</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">cyclic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;convert cycles from standard 1-based to cycle form</span>
<span class="sd">    accepted by Partition</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.permutations import cyclic</span>
<span class="sd">    &gt;&gt;&gt; a = [(1,2,3)]</span>
<span class="sd">    &gt;&gt;&gt; cyclic(a, 5)</span>
<span class="sd">    [[0, 1, 2], [3], [4]]</span>
<span class="sd">    &gt;&gt;&gt; a = [(1,2,3),(4,5)]</span>
<span class="sd">    &gt;&gt;&gt; cyclic(a, 5)</span>
<span class="sd">    [[0, 1, 2], [3, 4]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">a1</span> <span class="o">+=</span> <span class="n">x</span>
        <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c">#print &#39;DB1 v=&#39;, v</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">a1</span><span class="p">:</span>
            <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">v</span>

<span class="k">def</span> <span class="nf">perm_af_parity</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the parity of a permutation in array form.</span>

<span class="sd">    The parity of a permutation reflects the parity of the</span>
<span class="sd">    number of inversions in the permutation, i.e., the</span>
<span class="sd">    number of pairs of x and y such that x &gt; y but p[x] &lt; p[y].</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.permutations import perm_af_parity</span>
<span class="sd">    &gt;&gt;&gt; perm_af_parity([0,1,2,3])</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; perm_af_parity([3,2,0,1])</span>
<span class="sd">    1</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    Permutation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">j</span>
            <span class="k">while</span> <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">perm_af_mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Product of two permutations in array form. The convention used is</span>
<span class="sd">    ab = first apply b, then apply a.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.permutations import perm_af_mul</span>
<span class="sd">    &gt;&gt;&gt; perm_af_mul([1,2,3,0], [3,2,0,1])</span>
<span class="sd">    [0, 3, 1, 2]</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    Permutation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The number of elements in the permutations &quot;</span>
                         <span class="s">&quot;do not match.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">perm_af_muln</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Product of several permutations in array form.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.permutations import perm_af_muln</span>
<span class="sd">    &gt;&gt;&gt; perm_af_muln([1,0,3,2],[2,3,0,1],[3,2,1,0])</span>
<span class="sd">    [0, 1, 2, 3]</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    Permutation, perm_af_mul</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No element&quot;</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The number of elements in the permutations &quot;</span>
                             <span class="s">&quot;don&#39;t match.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">perm_af_mul</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
       <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">a</span>
       <span class="k">return</span> <span class="p">[</span><span class="n">p0</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
       <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="o">=</span> <span class="n">a</span>
       <span class="k">return</span> <span class="p">[</span><span class="n">p0</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p3</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
       <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span> <span class="o">=</span> <span class="n">a</span>
       <span class="k">return</span> <span class="p">[</span><span class="n">p0</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="n">p2</span><span class="p">[</span><span class="n">p3</span><span class="p">[</span><span class="n">i</span><span class="p">]]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p4</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
       <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">p5</span> <span class="o">=</span> <span class="n">a</span>
       <span class="k">return</span> <span class="p">[</span><span class="n">p0</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="n">p2</span><span class="p">[</span><span class="n">p3</span><span class="p">[</span><span class="n">p4</span><span class="p">[</span><span class="n">i</span><span class="p">]]]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p5</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
       <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">p5</span><span class="p">,</span> <span class="n">p6</span> <span class="o">=</span> <span class="n">a</span>
       <span class="k">return</span> <span class="p">[</span><span class="n">p0</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="n">p2</span><span class="p">[</span><span class="n">p3</span><span class="p">[</span><span class="n">p4</span><span class="p">[</span><span class="n">p5</span><span class="p">[</span><span class="n">i</span><span class="p">]]]]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p6</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">perm_af_muln</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">[:</span><span class="n">m</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">perm_af_muln</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="o">//</span><span class="mi">2</span><span class="p">:])</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">p0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">perm_af_invert</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the invert of the list a interpreted as the array</span>
<span class="sd">    form of a permutation. The result is again given as a list.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.permutations import perm_af_invert</span>
<span class="sd">    &gt;&gt;&gt; perm_af_invert([1,2,3,0])</span>
<span class="sd">    [3, 0, 1, 2]</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    Permutation, __invert__</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">inv_form</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">inv_form</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">inv_form</span>

<span class="k">def</span> <span class="nf">perm_af_commutes_with</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the two permutations with array forms</span>
<span class="sd">    given by a and b commute.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.permutations import perm_af_commutes_with</span>
<span class="sd">    &gt;&gt;&gt; perm_af_commutes_with([1,2,0],[0,2,1])</span>
<span class="sd">    False</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    Permutation, commutes_with</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The number of elements in the permutations &quot;</span>
                         <span class="s">&quot;don&#39;t match.&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>

<div class="viewcode-block" id="Permutation"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation">[docs]</a><span class="k">class</span> <span class="nc">Permutation</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A permutation, alternatively known as an &#39;arrangement number&#39; or &#39;ordering&#39;</span>
<span class="sd">    is an arrangement of the elements of an ordered list into a one-to-one</span>
<span class="sd">    mapping with itself. The number of permutations on a set of n elements is</span>
<span class="sd">    given by n!.</span>

<span class="sd">    A representation of a permutation as a product of permutation cycles is</span>
<span class="sd">    unique (up to the ordering of the cycles). An example of a cyclic</span>
<span class="sd">    decomposition is the permutation [3, 1, 0, 2] of the set [0, 1, 2, 3].</span>
<span class="sd">    This is denoted as [[1], [0, 3, 2]], corresponding to the disjoint</span>
<span class="sd">    permutation cycles [1] and [0, 3, 2]. We can choose the cyclic form as we</span>
<span class="sd">    want since the cycles are disjoint and can therefore be specified in any</span>
<span class="sd">    order and a rotation of a given cycle specifies the same cycle [1]_.</span>
<span class="sd">    Therefore, (320)(1), (203)(1), (032)(1), (1)(320), (1)(203), and (1)(032)</span>
<span class="sd">    all describe the same permutation.</span>

<span class="sd">    Another notation that explicitly identifies the positions occupied by</span>
<span class="sd">    elements before and after application of a permutation on n elements uses a</span>
<span class="sd">    2xn matrix, where the first row is the identity permutation and the second</span>
<span class="sd">    row is the new arrangement [2]_.</span>

<span class="sd">    Any permutation is also a product of transpositions.</span>

<span class="sd">    Permutations are commonly denoted in lexicographic or transposition order.</span>

<span class="sd">    The product of two permutations a and q is defined as their composition as</span>
<span class="sd">    functions, (p*q)(i) = p(q(i)) [6]_.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] Skiena, S. &#39;Permutations.&#39; 1.1 in Implementing Discrete Mathematics</span>
<span class="sd">           Combinatorics and Graph Theory with Mathematica.  Reading, MA:</span>
<span class="sd">           Addison-Wesley, pp. 3-16, 1990.</span>

<span class="sd">    .. [2] Knuth, D. E. The Art of Computer Programming, Vol. 4: Combinatorial</span>
<span class="sd">           Algorithms, 1st ed. Reading, MA: Addison-Wesley, 2011.</span>

<span class="sd">    .. [3] Wendy Myrvold and Frank Ruskey. 2001. Ranking and unranking</span>
<span class="sd">           permutations in linear time. Inf. Process. Lett. 79, 6 (September 2001),</span>
<span class="sd">           281-284. DOI=10.1016/S0020-0190(01)00141-7</span>

<span class="sd">    .. [4] D. L. Kreher, D. R. Stinson &#39;Combinatorial Algorithms&#39;</span>
<span class="sd">           CRC Press, 1999</span>

<span class="sd">    .. [5] Graham, R. L.; Knuth, D. E.; and Patashnik, O.</span>
<span class="sd">           Concrete Mathematics: A Foundation for Computer Science, 2nd ed.</span>
<span class="sd">           Reading, MA: Addison-Wesley, 1994.</span>

<span class="sd">    .. [6] http://en.wikipedia.org/wiki/Permutation#Product_and_inverse</span>

<span class="sd">    .. [7] http://en.wikipedia.org/wiki/Lehmer_code</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">is_Permutation</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="n">_array_form</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_cyclic_form</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the Permutation object.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        Permutation([0, 1, 2])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([[0,1],[2]])</span>
<span class="sd">        &gt;&gt;&gt; q</span>
<span class="sd">        Permutation([[0, 1], [2]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> \
           <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">is_sequence</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Permutation argument must be a list of ints &quot;</span>
                             <span class="s">&quot;or a list of lists.&quot;</span><span class="p">)</span>

        <span class="c"># 0, 1, ..., n-1 should all be present</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)))</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
            <span class="c"># XXX allow arbitrary elements like Partition does</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Integers 0 through </span><span class="si">%s</span><span class="s"> must be present.&quot;</span> <span class="o">%</span>
                             <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>

        <span class="n">cform</span> <span class="o">=</span> <span class="n">aform</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">cform</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aform</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">ret_obj</span> <span class="o">=</span> <span class="n">Basic</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="p">(</span><span class="n">cform</span> <span class="ow">or</span> <span class="n">aform</span><span class="p">),</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">)</span>
        <span class="n">ret_obj</span><span class="o">.</span><span class="n">_cyclic_form</span><span class="p">,</span> <span class="n">ret_obj</span><span class="o">.</span><span class="n">_array_form</span> <span class="o">=</span> <span class="n">cform</span><span class="p">,</span> <span class="n">aform</span>
        <span class="k">return</span> <span class="n">ret_obj</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.array_form"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.array_form">[docs]</a>    <span class="k">def</span> <span class="nf">array_form</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is used to convert from cyclic notation to the</span>
<span class="sd">        canonical notation.</span>
<span class="sd">        Currently singleton cycles need to be written</span>
<span class="sd">        explicitly.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([[2,0],[3,1]])</span>
<span class="sd">        &gt;&gt;&gt; p.array_form</span>
<span class="sd">        [2, 3, 0, 1]</span>
<span class="sd">        &gt;&gt;&gt; Permutation([[2,0,3,1]]).array_form</span>
<span class="sd">        [3, 2, 0, 1]</span>
<span class="sd">        &gt;&gt;&gt; Permutation([2,0,3,1]).array_form</span>
<span class="sd">        [2, 0, 3, 1]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        cyclic_form</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array_form</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array_form</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_array_form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_array_form</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cycles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">size</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">perm</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">perm</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_array_form</span> <span class="o">=</span> <span class="n">perm</span>
        <span class="k">return</span> <span class="n">perm</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.cyclic_form"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.cyclic_form">[docs]</a>    <span class="k">def</span> <span class="nf">cyclic_form</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is used to convert to the cyclic notation</span>
<span class="sd">        from the canonical notation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,3,1,2])</span>
<span class="sd">        &gt;&gt;&gt; p.cyclic_form</span>
<span class="sd">        [[1, 3, 2], [0]]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        array_form</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span>
        <span class="n">linear_rep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">unchecked</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">linear_rep</span><span class="p">)</span>
        <span class="n">cyclic_form</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">linear_rep</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">unchecked</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">cycle</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">unchecked</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">while</span> <span class="n">unchecked</span><span class="p">[</span><span class="n">linear_rep</span><span class="p">[</span><span class="n">j</span><span class="p">]]:</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">linear_rep</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">unchecked</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">cyclic_form</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
        <span class="n">cyclic_form</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span> <span class="o">=</span> <span class="n">cyclic_form</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cyclic_form</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reduced_cyclic_form</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cyclic_form</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.size"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.size">[docs]</a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of numbers in the permutation</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation([[3, 2], [0, 1]]).size</span>
<span class="sd">        4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Routine for addition of permutations by their inversion vectors.</span>

<span class="sd">        This is defined in terms of the Lehmer code of a</span>
<span class="sd">        permutation. The Lehmer code is nothing but the</span>
<span class="sd">        inversion vector of a permutation. In this scheme</span>
<span class="sd">        the identity permutation is like a zero element.</span>
<span class="sd">        See [1].</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([2,1,3,0])</span>
<span class="sd">        &gt;&gt;&gt; p+q == q</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; a = Permutation([0, 3, 1, 2])</span>
<span class="sd">        &gt;&gt;&gt; b = Permutation([2, 1, 0, 3])</span>
<span class="sd">        &gt;&gt;&gt; a+b</span>
<span class="sd">        Permutation([2, 0, 1, 3])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        __sub__, inversion_vector</span>

<span class="sd">        References</span>
<span class="sd">        ==========</span>
<span class="sd">        [1] http://en.wikipedia.org/wiki/Lehmer_code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The permutations must be of equal size.&quot;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inversion_vector</span><span class="p">()</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">inversion_vector</span><span class="p">()</span>
        <span class="n">result_inv</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">Permutation</span><span class="o">.</span><span class="n">from_inversion_vector</span><span class="p">(</span><span class="n">result_inv</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Routine for subtraction of permutations by their inversion vectors.</span>

<span class="sd">        The idea behind this is the same as in ``__add__``</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([2,1,3,0])</span>
<span class="sd">        &gt;&gt;&gt; q-p==q</span>
<span class="sd">        True</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        __add__, inversion_vector</span>

<span class="sd">        References</span>
<span class="sd">        ==========</span>
<span class="sd">        [1] http://en.wikipedia.org/wiki/Lehmer_code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The permutations must be of equal size.&quot;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inversion_vector</span><span class="p">()</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">inversion_vector</span><span class="p">()</span>
        <span class="n">result_inv</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">Permutation</span><span class="o">.</span><span class="n">from_inversion_vector</span><span class="p">(</span><span class="n">result_inv</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Routine for multiplication of permutations.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([1,2,3,0])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([3,2,0,1])</span>
<span class="sd">        &gt;&gt;&gt; p*q</span>
<span class="sd">        Permutation([0, 3, 1, 2])</span>

<span class="sd">        If one of the permutations is in a cyclic form then it is first</span>
<span class="sd">        converted to an array form and then multiplied. ::</span>

<span class="sd">        &gt;&gt;&gt; q = Permutation([[1,3,2],[0]])</span>
<span class="sd">        &gt;&gt;&gt; p*q</span>
<span class="sd">        Permutation([1, 0, 2, 3])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The number of elements in the permutations &quot;</span>
                             <span class="s">&quot;do not match.&quot;</span><span class="p">)</span>

        <span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>

<div class="viewcode-block" id="Permutation.commutes_with"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.commutes_with">[docs]</a>    <span class="k">def</span> <span class="nf">commutes_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the elements are commuting.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; a = Permutation([1,4,3,0,2,5])</span>
<span class="sd">        &gt;&gt;&gt; b = Permutation([0,1,2,3,4,5])</span>
<span class="sd">        &gt;&gt;&gt; a.commutes_with(b)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; b = Permutation([2,3,5,4,1,0])</span>
<span class="sd">        &gt;&gt;&gt; a.commutes_with(b)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">return</span> <span class="n">perm_af_commutes_with</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Routine for finding powers of a permutation.</span>

<span class="sd">        Power notation is also used for conjugation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([2,0,3,1])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([1,0,3,2])</span>
<span class="sd">        &gt;&gt;&gt; r = Permutation([0,2,3,1])</span>
<span class="sd">        &gt;&gt;&gt; p**4</span>
<span class="sd">        Permutation([0, 1, 2, 3])</span>
<span class="sd">        &gt;&gt;&gt; p**q == p.conjugate(q)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; q**p == q.conjugate(p)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; (p**q)**r == p**(q * r)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">Permutation</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Permutation</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
                    <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">4</span>
                <span class="k">elif</span> <span class="n">n</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<div class="viewcode-block" id="Permutation.transpositions"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.transpositions">[docs]</a>    <span class="k">def</span> <span class="nf">transpositions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the permutation as a product of transpositions.</span>

<span class="sd">        It is always possible to express a permutation as the product of</span>
<span class="sd">        transpositions, see [1]</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([[1,2,3],[0,4,5,6,7]])</span>
<span class="sd">        &gt;&gt;&gt; p.transpositions()</span>
<span class="sd">        [(1, 3), (1, 2), (0, 7), (0, 6), (0, 5), (0, 4)]</span>

<span class="sd">        References</span>
<span class="sd">        ==========</span>
<span class="sd">        [1]</span>
<span class="sd">        http://en.wikipedia.org/wiki/Transposition_%28mathematics%29#Properties</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cyclic_form</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nx</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">nx</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">first</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">res</span>
</div>
    <span class="k">def</span> <span class="nf">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds the invert of a permutation.</span>

<span class="sd">        A permutation multiplied by its invert equals</span>
<span class="sd">        the identity permutation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([[2,0],[3,1]])</span>
<span class="sd">        &gt;&gt;&gt; ~p</span>
<span class="sd">        Permutation([2, 3, 0, 1])</span>
<span class="sd">        &gt;&gt;&gt; p*(~p) == Permutation([0,1,2,3])</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">inv_form</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">inv_form</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">inv_form</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows applying a permutation instance as a bijective function.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([[2,0],[3,1]])</span>
<span class="sd">        &gt;&gt;&gt; p(3)</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Arguments must be integers.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span>

<div class="viewcode-block" id="Permutation.atoms"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.atoms">[docs]</a>    <span class="k">def</span> <span class="nf">atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all the elements of a permutation</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation([0, 1, 2, 3, 4, 5]).atoms()</span>
<span class="sd">        set([0, 1, 2, 3, 4, 5])</span>
<span class="sd">        &gt;&gt;&gt; Permutation([[0, 1], [2, 3], [4, 5]]).atoms()</span>
<span class="sd">        set([0, 1, 2, 3, 4, 5])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Permutation.next_lex"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.next_lex">[docs]</a>    <span class="k">def</span> <span class="nf">next_lex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the next permutation in lexicographical order.</span>
<span class="sd">        If self is the last permutation in lexicographical order</span>
<span class="sd">        it returns None.</span>
<span class="sd">        See [4] section 2.4.</span>


<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([2, 3, 1, 0])</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([2, 3, 1, 0]); p.rank()</span>
<span class="sd">        17</span>
<span class="sd">        &gt;&gt;&gt; p = p.next_lex(); p.rank()</span>
<span class="sd">        18</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        rank, unrank_lex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">[:]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Permutation.unrank_nonlex"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.unrank_nonlex">[docs]</a>    <span class="k">def</span> <span class="nf">unrank_nonlex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a linear time unranking algorithm that does not</span>
<span class="sd">        respect lexicographic order [3].</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation.unrank_nonlex(4, 5)</span>
<span class="sd">        Permutation([2, 0, 3, 1])</span>
<span class="sd">        &gt;&gt;&gt; Permutation.unrank_nonlex(4, -1)</span>
<span class="sd">        Permutation([0, 1, 2, 3])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        next_nonlex, rank_nonlex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">_unrank1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">a</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span> <span class="o">%</span> <span class="n">n</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">_unrank1</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">//</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

        <span class="n">id_perm</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">%</span> <span class="n">ifac</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">_unrank1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">id_perm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">id_perm</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Permutation.rank_nonlex"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.rank_nonlex">[docs]</a>    <span class="k">def</span> <span class="nf">rank_nonlex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv_perm</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a linear time ranking algorithm that does not</span>
<span class="sd">        enforce lexicographic order [3].</span>


<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; p.rank_nonlex()</span>
<span class="sd">        23</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        next_nonlex, unrank_nonlex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">_rank1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">perm</span><span class="p">,</span> <span class="n">inv_perm</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">inv_perm</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">perm</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">s</span>
            <span class="n">inv_perm</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">inv_perm</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">inv_perm</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">t</span>
            <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="n">n</span><span class="o">*</span><span class="n">_rank1</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">perm</span><span class="p">,</span> <span class="n">inv_perm</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inv_perm</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">inv_perm</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inv_perm</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">[:]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">_rank1</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">),</span> <span class="n">perm</span><span class="p">,</span> <span class="n">inv_perm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span>
</div>
<div class="viewcode-block" id="Permutation.next_nonlex"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.next_nonlex">[docs]</a>    <span class="k">def</span> <span class="nf">next_nonlex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the next permutation in nonlex order [3].</span>
<span class="sd">        If self is the last permutation in this order it returns None.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([2, 0, 3, 1]); p.rank_nonlex()</span>
<span class="sd">        5</span>
<span class="sd">        &gt;&gt;&gt; p = p.next_nonlex(); p</span>
<span class="sd">        Permutation([3, 0, 1, 2])</span>
<span class="sd">        &gt;&gt;&gt; p.rank_nonlex()</span>
<span class="sd">        6</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        rank_nonlex, unrank_nonlex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank_nonlex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">ifac</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">Permutation</span><span class="o">.</span><span class="n">unrank_nonlex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Permutation.rank"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.rank">[docs]</a>    <span class="k">def</span> <span class="nf">rank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the lexicographic rank of the permutation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; p.rank()</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3,2,1,0])</span>
<span class="sd">        &gt;&gt;&gt; p.rank()</span>
<span class="sd">        23</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        next_lex, unrank_lex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">[:]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">psize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ifac</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">rank</span> <span class="o">+=</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">psize</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                    <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">psize</span> <span class="o">//=</span> <span class="n">n</span>
            <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">rank</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.cardinality"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.cardinality">[docs]</a>    <span class="k">def</span> <span class="nf">cardinality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of all possible permutations.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; p.cardinality</span>
<span class="sd">        24</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">ifac</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Permutation.parity"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.parity">[docs]</a>    <span class="k">def</span> <span class="nf">parity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the parity of a permutation.</span>

<span class="sd">        The parity of a permutation reflects the parity of the</span>
<span class="sd">        number of inversions in the permutation, i.e., the</span>
<span class="sd">        number of pairs of x and y such that ``x &gt; y`` but ``p[x] &lt; p[y]``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; p.parity()</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3,2,0,1])</span>
<span class="sd">        &gt;&gt;&gt; p.parity()</span>
<span class="sd">        1</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        perm_af_parity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="n">perm_af_parity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.is_even"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.is_even">[docs]</a>    <span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if a permutation is even.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; p.is_even</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3,2,1,0])</span>
<span class="sd">        &gt;&gt;&gt; p.is_even</span>
<span class="sd">        True</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        is_odd</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">S</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="p">())</span><span class="o">.</span><span class="n">is_even</span></div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.is_odd"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.is_odd">[docs]</a>    <span class="k">def</span> <span class="nf">is_odd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if a permutation is odd.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; p.is_odd</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3,2,0,1])</span>
<span class="sd">        &gt;&gt;&gt; p.is_odd</span>
<span class="sd">        True</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        is_even</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">S</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="p">())</span><span class="o">.</span><span class="n">is_odd</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.is_Singleton"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.is_Singleton">[docs]</a>    <span class="k">def</span> <span class="nf">is_Singleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to see if the permutation contains only one number</span>
<span class="sd">        Therefore there is only one possible permutation of this set of numbers</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation([0]).is_Singleton</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Permutation([0, 1]).is_Singleton</span>
<span class="sd">        False</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        is_Empty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.is_Empty"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.is_Empty">[docs]</a>    <span class="k">def</span> <span class="nf">is_Empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to see if the permutation is a set with zero elements</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation([]).is_Empty</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Permutation([0]).is_Empty</span>
<span class="sd">        False</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        is_Singleton</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.is_Identity"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.is_Identity">[docs]</a>    <span class="k">def</span> <span class="nf">is_Identity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the Permutation is an identity permutation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([[0],[1],[2]])</span>
<span class="sd">        &gt;&gt;&gt; p.is_Identity</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2])</span>
<span class="sd">        &gt;&gt;&gt; p.is_Identity</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,2,1])</span>
<span class="sd">        &gt;&gt;&gt; p.is_Identity</span>
<span class="sd">        False</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        order</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cyclic_form</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">==</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Permutation.ascents"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.ascents">[docs]</a>    <span class="k">def</span> <span class="nf">ascents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the positions of ascents in a permutation, ie, the location</span>
<span class="sd">        where p[i] &lt; p[i+1]</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([4,0,1,3,2])</span>
<span class="sd">        &gt;&gt;&gt; p.ascents()</span>
<span class="sd">        [1, 2]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        descents, inversions, min, max</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">pos</span>
</div>
<div class="viewcode-block" id="Permutation.descents"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.descents">[docs]</a>    <span class="k">def</span> <span class="nf">descents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the positions of descents in a permutation, ie, the location</span>
<span class="sd">        where p[i] &gt; p[i+1]</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([4,0,1,3,2])</span>
<span class="sd">        &gt;&gt;&gt; p.descents()</span>
<span class="sd">        [0, 3]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        ascents, inversions, min, max</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">pos</span>
</div>
<div class="viewcode-block" id="Permutation.max"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.max">[docs]</a>    <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The maximum element moved by the permutation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([1,0,2,3,4])</span>
<span class="sd">        &gt;&gt;&gt; p.max()</span>
<span class="sd">        1</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        min, descents, ascents, inversions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
                <span class="nb">max</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">max</span>
</div>
<div class="viewcode-block" id="Permutation.min"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.min">[docs]</a>    <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The minimum element moved by the permutation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,4,3,2])</span>
<span class="sd">        &gt;&gt;&gt; p.min()</span>
<span class="sd">        2</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        max, descents, ascents, inversions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="nb">min</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">:</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">min</span>
</div>
<div class="viewcode-block" id="Permutation.inversions"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.inversions">[docs]</a>    <span class="k">def</span> <span class="nf">inversions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the number of inversions of a permutation.</span>

<span class="sd">        An inversion is where i &gt; j but p[i] &lt; p[j].</span>

<span class="sd">        For small length of p, it iterates over all i and j</span>
<span class="sd">        values and calculates the number of inversions.</span>
<span class="sd">        For large length of p, it uses a variation of merge</span>
<span class="sd">        sort to calculate the number of inversions.</span>
<span class="sd">        References</span>
<span class="sd">        =========</span>
<span class="sd">        [1] http://www.cp.eng.chula.ac.th/~piak/teaching/algo/algo2008/count-inv.htm</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3,4,5])</span>
<span class="sd">        &gt;&gt;&gt; p.inversions()</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; Permutation([3,2,1,0]).inversions()</span>
<span class="sd">        6</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        descents, ascents, min, max</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inversions</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">130</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
                    <span class="k">if</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">:</span>
                        <span class="n">inversions</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:]</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:]</span>
            <span class="k">while</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                    <span class="n">right</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">right</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
                        <span class="n">right</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">inversions</span> <span class="o">+=</span> <span class="n">_merge</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">inversions</span>
</div>
<div class="viewcode-block" id="Permutation.conjugate"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.conjugate">[docs]</a>    <span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the conjugate Permutation ``~x*p*x``</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; a = Permutation([0,2,1,3])</span>
<span class="sd">        &gt;&gt;&gt; b = Permutation([0,2,3,1])</span>
<span class="sd">        &gt;&gt;&gt; a.conjugate(b)</span>
<span class="sd">        Permutation([0, 3, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; ~b*a*b</span>
<span class="sd">        Permutation([0, 3, 2, 1])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The number of elements in the permutations &quot;</span>
                             <span class="s">&quot;do not match.&quot;</span><span class="p">)</span>
        <span class="n">invb</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">invb</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">([</span><span class="n">invb</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">b</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Permutation.commutator"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.commutator">[docs]</a>    <span class="k">def</span> <span class="nf">commutator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the commutator Permutation ``~p*~x*p*x``</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; a = Permutation([0,2,1,3])</span>
<span class="sd">        &gt;&gt;&gt; b = Permutation([0,2,3,1])</span>
<span class="sd">        &gt;&gt;&gt; a.commutator(b)</span>
<span class="sd">        Permutation([0, 3, 1, 2])</span>
<span class="sd">        &gt;&gt;&gt; ~a*~b*a*b</span>
<span class="sd">        Permutation([0, 3, 1, 2])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The number of elements in the permutations &quot;</span>
                             <span class="s">&quot;do not match.&quot;</span><span class="p">)</span>
        <span class="n">inva</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">inva</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">invb</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">invb</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">([</span><span class="n">inva</span><span class="p">[</span><span class="n">invb</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">b</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Permutation.signature"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.signature">[docs]</a>    <span class="k">def</span> <span class="nf">signature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gives the signature of the permutation needed to place the</span>
<span class="sd">        elements of the permutation in canonical order.</span>

<span class="sd">        The signature is calculated as (-1)^&lt;# no. of inversions&gt;</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2])</span>
<span class="sd">        &gt;&gt;&gt; p.signature()</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([0,2,1])</span>
<span class="sd">        &gt;&gt;&gt; q.signature()</span>
<span class="sd">        -1</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        inversions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_even</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</div>
<div class="viewcode-block" id="Permutation.order"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.order">[docs]</a>    <span class="k">def</span> <span class="nf">order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the order of a permutation.</span>

<span class="sd">        When the permutation is raised to the power of its</span>
<span class="sd">        order it equals the identity permutation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3,1,5,2,4,0])</span>
<span class="sd">        &gt;&gt;&gt; p.order()</span>
<span class="sd">        4</span>
<span class="sd">        &gt;&gt;&gt; (p**(p.order()))</span>
<span class="sd">        Permutation([0, 1, 2, 3, 4, 5])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        identity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">lcm</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span> <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cyclic_form</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Permutation.length"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.length">[docs]</a>    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of integers moved by a permutation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation([0, 3, 2, 1]).length()</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; Permutation([[0, 1], [2, 3]]).length()</span>
<span class="sd">        4</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        min, max</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">length</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">length</span>

</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Permutation.cycles"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.cycles">[docs]</a>    <span class="k">def</span> <span class="nf">cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of cycles that the permutation</span>
<span class="sd">        has been decomposed into.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation([0, 1, 2]).cycles</span>
<span class="sd">        3</span>
<span class="sd">        &gt;&gt;&gt; Permutation([[0, 1], [2, 3]]).cycles</span>
<span class="sd">        2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cyclic_form</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Permutation.index"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.index">[docs]</a>    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the index of a permutation.</span>

<span class="sd">        The index of a permutation is the sum of all</span>
<span class="sd">        subscripts j such that p[j] is greater than</span>
<span class="sd">        p[j+1].</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3, 0, 2, 1, 4])</span>
<span class="sd">        &gt;&gt;&gt; p.index()</span>
<span class="sd">        2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>

        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
</div>
<div class="viewcode-block" id="Permutation.runs"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.runs">[docs]</a>    <span class="k">def</span> <span class="nf">runs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the runs of a permutation.</span>

<span class="sd">        An ascending sequence in a permutation is called a run [5]</span>


<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([2,5,7,3,6,0,1,4,8])</span>
<span class="sd">        &gt;&gt;&gt; p.runs()</span>
<span class="sd">        [[2, 5, 7], [3, 6], [0, 1, 4, 8]]</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([1,3,2,0])</span>
<span class="sd">        &gt;&gt;&gt; q.runs()</span>
<span class="sd">        [[1, 3], [2], [0]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cycles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">temp_cycle</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">current_elem</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">next_elem</span>    <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">current_elem</span> <span class="o">&lt;</span> <span class="n">next_elem</span><span class="p">:</span>
                <span class="n">temp_cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_elem</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">current_elem</span> <span class="o">&gt;</span> <span class="n">next_elem</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">temp_cycle</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> \
                       <span class="n">temp_cycle</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">current_elem</span><span class="p">:</span>
                    <span class="n">temp_cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_elem</span><span class="p">)</span>
                    <span class="n">cycles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_cycle</span><span class="p">)</span>
                    <span class="n">temp_cycle</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">temp_cycle</span> <span class="o">!=</span> <span class="p">[]:</span>
                        <span class="n">cycles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_cycle</span><span class="p">)</span>
                    <span class="n">cycles</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">current_elem</span><span class="p">])</span>
                    <span class="n">temp_cycle</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">continue</span>

        <span class="k">if</span> <span class="n">current_elem</span> <span class="o">&lt;</span> <span class="n">next_elem</span><span class="p">:</span>
            <span class="n">temp_cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_elem</span><span class="p">)</span>
            <span class="n">cycles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_cycle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">temp_cycle</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">cycles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_cycle</span><span class="p">)</span>
            <span class="n">cycles</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">next_elem</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">cycles</span>
</div>
<div class="viewcode-block" id="Permutation.inversion_vector"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.inversion_vector">[docs]</a>    <span class="k">def</span> <span class="nf">inversion_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the inversion vector of the permutation.</span>

<span class="sd">        The inversion vector consists of elements whose value</span>
<span class="sd">        indicates the number of elements in the permutation</span>
<span class="sd">        that are lesser than it and lie on its right hand side.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([4,8,0,7,1,5,3,6,2])</span>
<span class="sd">        &gt;&gt;&gt; p.inversion_vector()</span>
<span class="sd">        [4, 7, 0, 5, 0, 2, 1, 1]</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3,2,1,0])</span>
<span class="sd">        &gt;&gt;&gt; p.inversion_vector()</span>
<span class="sd">        [3, 2, 1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">self_array_form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self_array_form</span><span class="p">)</span>
        <span class="n">inversion_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">self_array_form</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">self_array_form</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">val</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">inversion_vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">inversion_vector</span>
</div>
<div class="viewcode-block" id="Permutation.rank_trotterjohnson"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.rank_trotterjohnson">[docs]</a>    <span class="k">def</span> <span class="nf">rank_trotterjohnson</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the Trotter Johnson rank, which we get from the minimal</span>
<span class="sd">        change algorithm. See [4] section 2.4.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; p.rank_trotterjohnson()</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0,2,1,3])</span>
<span class="sd">        &gt;&gt;&gt; p.rank_trotterjohnson()</span>
<span class="sd">        7</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        unrank_trotterjohnson, next_trotterjohnson</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span> <span class="o">==</span> <span class="p">[]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Identity</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">j1</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">rank</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rank</span> <span class="o">=</span> <span class="n">j1</span><span class="o">*</span><span class="n">rank</span> <span class="o">+</span> <span class="n">j1</span> <span class="o">-</span> <span class="n">k</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rank</span> <span class="o">=</span> <span class="n">j1</span><span class="o">*</span><span class="n">rank</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">rank</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Permutation.unrank_trotterjohnson"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.unrank_trotterjohnson">[docs]</a>    <span class="k">def</span> <span class="nf">unrank_trotterjohnson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rank</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Trotter Johnson permutation unranking. See [4] section 2.4.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation.unrank_trotterjohnson(5,10)</span>
<span class="sd">        Permutation([0, 3, 1, 2, 4])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        rank_trotterjohnson, next_trotterjohnson</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">size</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">ifac</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">pj</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">pj</span> <span class="o">*=</span> <span class="n">j</span>
            <span class="n">r1</span> <span class="o">=</span> <span class="p">(</span><span class="n">rank</span> <span class="o">*</span> <span class="n">pj</span><span class="p">)</span> <span class="o">//</span> <span class="n">n</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">j</span><span class="o">*</span><span class="n">r2</span>
            <span class="k">if</span> <span class="n">r2</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">perm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Permutation.next_trotterjohnson"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.next_trotterjohnson">[docs]</a>    <span class="k">def</span> <span class="nf">next_trotterjohnson</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the next permutation in Trotter-Johnson order.</span>
<span class="sd">        If self is the last permutation it returns None.</span>
<span class="sd">        See [4] section 2.4.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([3, 0, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; p.rank_trotterjohnson()</span>
<span class="sd">        4</span>
<span class="sd">        &gt;&gt;&gt; p = p.next_trotterjohnson(); p</span>
<span class="sd">        Permutation([0, 3, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; p.rank_trotterjohnson()</span>
<span class="sd">        5</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        rank_trotterjohnson, unrank_trotterjohnson</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span><span class="p">[:]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">st</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[:]</span>
        <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
                <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">par</span> <span class="o">=</span> <span class="n">perm_af_parity</span><span class="p">(</span><span class="n">rho</span><span class="p">[:</span><span class="n">m</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">par</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="n">m</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="p">],</span> <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="p">]</span>
                    <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="n">st</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="p">],</span> <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pi</span><span class="p">[</span><span class="n">st</span><span class="o">+</span><span class="n">d</span><span class="p">]</span>
                    <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Permutation.get_precedence_matrix"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.get_precedence_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">get_precedence_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the precedence matrix. This is used for computing the</span>
<span class="sd">        distance between two permutations.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation.josephus(3,6,1)</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        Permutation([2, 5, 3, 1, 4, 0])</span>
<span class="sd">        &gt;&gt;&gt; p.get_precedence_matrix()</span>
<span class="sd">        [0, 0, 0, 0, 0, 0]</span>
<span class="sd">        [1, 0, 0, 0, 1, 0]</span>
<span class="sd">        [1, 1, 0, 1, 1, 1]</span>
<span class="sd">        [1, 1, 0, 0, 1, 0]</span>
<span class="sd">        [1, 0, 0, 0, 0, 0]</span>
<span class="sd">        [1, 1, 0, 1, 1, 0]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        get_precedence_distance, get_adjacency_matrix, get_adjacency_distance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="n">m</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">m</span>
</div>
<div class="viewcode-block" id="Permutation.get_precedence_distance"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.get_precedence_distance">[docs]</a>    <span class="k">def</span> <span class="nf">get_precedence_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the precedence distance between two permutations.</span>

<span class="sd">        Suppose p and p&#39; represent n jobs. The precedence metric</span>
<span class="sd">        counts the number of times a job j is prededed by job i</span>
<span class="sd">        in both p and p&#39;. This metric is commutative.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([2, 0, 4, 3, 1])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([3, 1, 2, 4, 0])</span>
<span class="sd">        &gt;&gt;&gt; p.get_precedence_distance(q)</span>
<span class="sd">        7</span>
<span class="sd">        &gt;&gt;&gt; q.get_precedence_distance(p)</span>
<span class="sd">        7</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        get_precedence_matrix, get_adjacency_matrix, get_adjacency_distance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The permutations must be of the same size.&quot;</span><span class="p">)</span>
        <span class="n">self_prec_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_precedence_matrix</span><span class="p">()</span>
        <span class="n">other_prec_mat</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_precedence_matrix</span><span class="p">()</span>
        <span class="n">n_prec</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">self_prec_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">other_prec_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">n_prec</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="n">n_prec</span>
        <span class="k">return</span> <span class="n">d</span>
</div>
<div class="viewcode-block" id="Permutation.get_adjacency_matrix"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.get_adjacency_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">get_adjacency_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the adjacency matrix of a permutation.</span>

<span class="sd">        If job i is adjacent to job j in a permutation p</span>
<span class="sd">        then we set m[i, j] = 1 where m is the adjacency</span>
<span class="sd">        matrix of p.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation.josephus(3,6,1)</span>
<span class="sd">        &gt;&gt;&gt; p.get_adjacency_matrix()</span>
<span class="sd">        [0, 0, 0, 0, 0, 0]</span>
<span class="sd">        [0, 0, 0, 0, 1, 0]</span>
<span class="sd">        [0, 0, 0, 0, 0, 1]</span>
<span class="sd">        [0, 1, 0, 0, 0, 0]</span>
<span class="sd">        [1, 0, 0, 0, 0, 0]</span>
<span class="sd">        [0, 0, 0, 1, 0, 0]</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation([0, 1, 2, 3])</span>
<span class="sd">        &gt;&gt;&gt; q.get_adjacency_matrix()</span>
<span class="sd">        [0, 1, 0, 0]</span>
<span class="sd">        [0, 0, 1, 0]</span>
<span class="sd">        [0, 0, 0, 1]</span>
<span class="sd">        [0, 0, 0, 0]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        get_precedence_matrix, get_precedence_distance, get_adjacency_distance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">m</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">m</span>
</div>
<div class="viewcode-block" id="Permutation.get_adjacency_distance"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.get_adjacency_distance">[docs]</a>    <span class="k">def</span> <span class="nf">get_adjacency_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the adjacency distance between two permutations.</span>

<span class="sd">        This metric counts the number of times a pair i,j of jobs is</span>
<span class="sd">        adjacent in both p and p&#39;. If n_adj is this quantity then</span>
<span class="sd">        the adjacency distance is n - n_adj - 1 [1]</span>

<span class="sd">        [1] Reeves, Colin R. Landscapes, Operators and Heuristic search, Annals</span>
<span class="sd">        of Operational Research, 86, pp 473-490. (1999)</span>


<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0, 3, 1, 2, 4])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation.josephus(4, 5, 2)</span>
<span class="sd">        &gt;&gt;&gt; p.get_adjacency_distance(q)</span>
<span class="sd">        3</span>
<span class="sd">        &gt;&gt;&gt; r = Permutation([0, 2, 1, 4, 3])</span>
<span class="sd">        &gt;&gt;&gt; p.get_adjacency_distance(r)</span>
<span class="sd">        4</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        get_precedence_matrix, get_precedence_distance, get_adjacency_matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The permutations must be of the same size.&quot;</span><span class="p">)</span>
        <span class="n">self_adj_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_adjacency_matrix</span><span class="p">()</span>
        <span class="n">other_adj_mat</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_adjacency_matrix</span><span class="p">()</span>
        <span class="n">n_adj</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">self_adj_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">other_adj_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">n_adj</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">n_adj</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">d</span>
</div>
<div class="viewcode-block" id="Permutation.get_positional_distance"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.get_positional_distance">[docs]</a>    <span class="k">def</span> <span class="nf">get_positional_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the positional distance between two permutations.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; p = Permutation([0, 3, 1, 2, 4])</span>
<span class="sd">        &gt;&gt;&gt; q = Permutation.josephus(4, 5, 2)</span>
<span class="sd">        &gt;&gt;&gt; r = Permutation([3, 1, 4, 0, 2])</span>
<span class="sd">        &gt;&gt;&gt; p.get_positional_distance(q)</span>
<span class="sd">        12</span>
<span class="sd">        &gt;&gt;&gt; p.get_positional_distance(r)</span>
<span class="sd">        12</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        get_precedence_distance, get_adjacency_distance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The permutations must be of the same size.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))])</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Permutation.josephus"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.josephus">[docs]</a>    <span class="k">def</span> <span class="nf">josephus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Josephus permutation for a given number of</span>
<span class="sd">        prisoners (n), frequency of removal (m) and desired number of</span>
<span class="sd">        survivors (s).</span>

<span class="sd">        There are people standing in a circle waiting to be executed.</span>
<span class="sd">        After the first person is executed, certain number of people</span>
<span class="sd">        are skipped and another person is executed. Then again, people</span>
<span class="sd">        are skipped and a person is executed. The elimination proceeds</span>
<span class="sd">        around the circle (which is becoming smaller and smaller as the</span>
<span class="sd">        executed people are removed), until only the last person</span>
<span class="sd">        remains, who is given freedom. The Josephus permutation is given</span>
<span class="sd">        by the order in which the prisoners are executed.</span>

<span class="sd">        References:</span>
<span class="sd">        [1] http://en.wikipedia.org/wiki/Flavius_Josephus</span>
<span class="sd">        [2] http://en.wikipedia.org/wiki/Josephus_problem</span>
<span class="sd">        [3] http://www.wou.edu/~burtonl/josephus.html</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation.josephus(3, 40, 1)</span>
<span class="sd">        Permutation([2, 5, 8, 11, 14, 17, 20, 23, 26, 29, 32, 35, \</span>
<span class="sd">        38, 1, 6, 10, 15, 19, 24, 28, 33, 37, 3, 9, 16, 22, 30, 36, \</span>
<span class="sd">        4, 13, 25, 34, 7, 21, 39, 18, 0, 31, 12, 27])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
        <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>
            <span class="n">perm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>
        <span class="n">perm</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Permutation</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Permutation.from_inversion_vector"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.from_inversion_vector">[docs]</a>    <span class="k">def</span> <span class="nf">from_inversion_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inversion</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the permutation from the inversion</span>
<span class="sd">        vector.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; Permutation.from_inversion_vector([3,2,1,0,0])</span>
<span class="sd">        Permutation([3, 2, 1, 0, 4, 5])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inversion</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">N</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">size</span><span class="p">)]</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="n">inversion</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                <span class="n">perm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="n">N</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The inversion vector is not valid.&quot;</span><span class="p">)</span>
        <span class="n">perm</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Permutation.random_permutation"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.random_permutation">[docs]</a>    <span class="k">def</span> <span class="nf">random_permutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a random permutation.</span>

<span class="sd">        Uses the underlying Python psuedo-random</span>
<span class="sd">        number generator.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; a = Permutation.random_permutation(5)</span>
<span class="sd">        &gt;&gt;&gt; (a*(~a)).is_Identity</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">perm_array</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">perm_array</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">perm_array</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Permutation.unrank_lex"><a class="viewcode-back" href="../../../modules/combinatorics/permutations.html#sympy.combinatorics.permutations.Permutation.unrank_lex">[docs]</a>    <span class="k">def</span> <span class="nf">unrank_lex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rank</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lexicographic permutation unranking.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; a = Permutation.unrank_lex(5,10)</span>
<span class="sd">        &gt;&gt;&gt; a.rank()</span>
<span class="sd">        10</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Permutation([0, 2, 4, 1, 3])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        rank, next_lex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">perm_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span>
        <span class="n">psize</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">new_psize</span> <span class="o">=</span> <span class="n">psize</span><span class="o">*</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">rank</span> <span class="o">%</span> <span class="n">new_psize</span><span class="p">)</span> <span class="o">//</span> <span class="n">psize</span>
            <span class="n">rank</span> <span class="o">-=</span> <span class="n">d</span><span class="o">*</span><span class="n">psize</span>
            <span class="n">perm_array</span><span class="p">[</span><span class="n">size</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">perm_array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">perm_array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">psize</span> <span class="o">=</span> <span class="n">new_psize</span>
        <span class="k">return</span> <span class="n">_new_from_array_form</span><span class="p">(</span><span class="n">perm_array</span><span class="p">)</span>
</div></div>
<span class="k">def</span> <span class="nf">_new_from_array_form</span><span class="p">(</span><span class="n">perm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    factory function to produce a Permutation object from a list;</span>
<span class="sd">    the list is bound to the _array_form attribute, so it must</span>
<span class="sd">    not be modified; this method is meant for internal use only;</span>
<span class="sd">    the list a is supposed to be generated as a temporary value in a method,</span>
<span class="sd">    so p = _new_from_array_form(a) is the only object to hold a</span>
<span class="sd">    reference to a::</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import _new_from_array_form</span>
<span class="sd">        &gt;&gt;&gt; a = [2,1,3,0]</span>
<span class="sd">        &gt;&gt;&gt; p = _new_from_array_form(a)</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        Permutation([2, 1, 3, 0])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Basic</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">Permutation</span><span class="p">,</span> <span class="n">perm</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">_array_form</span> <span class="o">=</span> <span class="n">perm</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">_merge</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for calculating inversions.This method is</span>
<span class="sd">    for internal use only.</span>
<span class="sd">    Merges two sorted arrays and calculates the inversion count.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">left</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">mid</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">left</span>
    <span class="n">inv_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mid</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">temp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">temp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">inv_count</span> <span class="o">+=</span> <span class="p">(</span><span class="n">mid</span> <span class="o">-</span><span class="n">i</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mid</span><span class="p">:</span>
        <span class="n">temp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">j</span> <span class="o">+=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">:</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">left</span><span class="p">:</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">:</span><span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">left</span><span class="p">:</span><span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">inv_count</span>

<span class="n">Perm</span> <span class="o">=</span> <span class="n">Permutation</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">SymPy 0.7.2-git documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../sympy.html" >sympy</a> &raquo;</li>
          <li><a href="../combinatorics.html" >sympy.combinatorics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008, 2009, 2010, 2011, 2012 SymPy Development Team.
      Last updated on Oct 01, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>